<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Canvas Image</title>
  </head>
  <body onload="handlerLoad()"></body>
  <div>
    <div>
      <canvas id="img-canvas">can not support canvas</canvas>
    </div>
    <div>
      <canvas id="img-canvas2" width="300" height="150">展示平铺</canvas>
    </div>
    <div>
      <canvas id="clicing-canvas" width="150" height="150"></canvas>
      <img id="source" src="fengjing.jpeg" width="300" height="227" />
      <img id="frame" src="xiangkuang.jpeg" width="132" height="150" />
    </div>
  </div>
  <script>
    var canvas, ctx;
    function handlerLoad() {
      canvas = document.getElementById("img-canvas");
      ctx = canvas.getContext("2d");

      const canvas2 = document.getElementById("img-canvas2");
      const ctx2 = canvas2.getContext("2d");

      let width = 300;
      let height = 300;

      canvas.width = width;
      canvas.height = height;

      let img = new Image();
      img.src = "./fengjing.jpeg";
      // img.src = "data:image/gif;base64,R0lGODlhCwALAIAAAAAA3pn/ZiH5BAEAAAEALAAAAAALAAsAAAIUhA+hkcuO4lmNVindo7qyrIXiGBYAOw==";
      img.onload = function () {
        ctx.drawImage(img, 0, 0, width, height);

        ctx.beginPath();
        ctx.moveTo(30, 96);
        ctx.lineTo(70, 66);
        ctx.lineTo(103, 76);
        ctx.lineTo(170, 15);
        ctx.strokeStyle = "blue";
        ctx.lineWidth = 5;
        ctx.stroke();

        for (var i = 0; i < 4; i++) {
          for (var j = 0; j < 3; j++) {
            ctx2.drawImage(img, j * 50, i * 38, 50, 38);
          }
        }
      };
      slicing();
    }
    function slicing() {
      const canvas2 = document.getElementById("clicing-canvas");
      const ctx2 = canvas2.getContext("2d");
      // Draw frame
      ctx2.drawImage(document.getElementById("frame"), 0, 0, 132, 150);
      // Draw slice
      ctx2.drawImage(
        document.getElementById("source"),
        33,
        71,
        104,
        124,
        21,
        20,
        87,
        104
      );
    }
  </script>
</html>
